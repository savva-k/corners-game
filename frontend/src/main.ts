import { CANVAS, Game, type Types } from 'phaser';
import { GAME_CONTAINER_ID, GLOBAL_REGISTRY_GAME_DATA, GLOBAL_REGISTRY_PLAYER, GLOBAL_REGISTRY_TRANSLATIONS } from './constan';
import { Game as MainGame } from './scenes/Game';
import { type Game as GameModel } from './model/Game';

const testGame: GameModel = JSON.parse('{"id":"2cf5d9ab-be2d-461e-8717-316f3a156059","gameMap":{"size":{"width":8,"height":8},"field":{"0,0":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":0,"y":0},"empty":true,"occupied":false},"4,4":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":4,"y":4},"empty":true,"occupied":false},"0,1":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":0,"y":1},"empty":true,"occupied":false},"4,5":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":4,"y":5},"empty":true,"occupied":false},"0,2":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":0,"y":2},"empty":true,"occupied":false},"4,6":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":4,"y":6},"empty":true,"occupied":false},"0,3":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":0,"y":3},"empty":true,"occupied":false},"4,7":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":4,"y":7},"empty":true,"occupied":false},"0,4":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":0,"y":4},"empty":true,"occupied":false},"0,5":{"tileMapName":"base-cell","tileNumber":1,"piece":"BLACK","position":{"x":0,"y":5},"empty":false,"occupied":true},"0,6":{"tileMapName":"base-cell","tileNumber":0,"piece":"BLACK","position":{"x":0,"y":6},"empty":false,"occupied":true},"0,7":{"tileMapName":"base-cell","tileNumber":1,"piece":"BLACK","position":{"x":0,"y":7},"empty":false,"occupied":true},"5,0":{"tileMapName":"base-cell","tileNumber":1,"piece":"WHITE","position":{"x":5,"y":0},"empty":false,"occupied":true},"5,1":{"tileMapName":"base-cell","tileNumber":0,"piece":"WHITE","position":{"x":5,"y":1},"empty":false,"occupied":true},"5,2":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":5,"y":2},"empty":true,"occupied":false},"5,3":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":5,"y":3},"empty":true,"occupied":false},"1,0":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":1,"y":0},"empty":true,"occupied":false},"5,4":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":5,"y":4},"empty":true,"occupied":false},"1,1":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":1,"y":1},"empty":true,"occupied":false},"5,5":{"tileMapName":"base-cell","tileNumber":0,"piece":"WHITE","position":{"x":5,"y":5},"empty":false,"occupied":true},"1,2":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":1,"y":2},"empty":true,"occupied":false},"5,6":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":5,"y":6},"empty":true,"occupied":false},"1,3":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":1,"y":3},"empty":true,"occupied":false},"5,7":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":5,"y":7},"empty":true,"occupied":false},"1,4":{"tileMapName":"base-cell","tileNumber":1,"piece":"BLACK","position":{"x":1,"y":4},"empty":false,"occupied":true},"1,5":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":1,"y":5},"empty":true,"occupied":false},"1,6":{"tileMapName":"base-cell","tileNumber":1,"piece":"BLACK","position":{"x":1,"y":6},"empty":false,"occupied":true},"1,7":{"tileMapName":"base-cell","tileNumber":0,"piece":"BLACK","position":{"x":1,"y":7},"empty":false,"occupied":true},"6,0":{"tileMapName":"base-cell","tileNumber":0,"piece":"WHITE","position":{"x":6,"y":0},"empty":false,"occupied":true},"6,1":{"tileMapName":"base-cell","tileNumber":1,"piece":"WHITE","position":{"x":6,"y":1},"empty":false,"occupied":true},"6,2":{"tileMapName":"base-cell","tileNumber":0,"piece":"WHITE","position":{"x":6,"y":2},"empty":false,"occupied":true},"6,3":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":6,"y":3},"empty":true,"occupied":false},"2,0":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":2,"y":0},"empty":true,"occupied":false},"6,4":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":6,"y":4},"empty":true,"occupied":false},"2,1":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":2,"y":1},"empty":true,"occupied":false},"6,5":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":6,"y":5},"empty":true,"occupied":false},"2,2":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":2,"y":2},"empty":true,"occupied":false},"6,6":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":6,"y":6},"empty":true,"occupied":false},"2,3":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":2,"y":3},"empty":true,"occupied":false},"6,7":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":6,"y":7},"empty":true,"occupied":false},"2,4":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":2,"y":4},"empty":true,"occupied":false},"2,5":{"tileMapName":"base-cell","tileNumber":1,"piece":"BLACK","position":{"x":2,"y":5},"empty":false,"occupied":true},"2,6":{"tileMapName":"base-cell","tileNumber":0,"piece":"BLACK","position":{"x":2,"y":6},"empty":false,"occupied":true},"2,7":{"tileMapName":"base-cell","tileNumber":1,"piece":"BLACK","position":{"x":2,"y":7},"empty":false,"occupied":true},"7,0":{"tileMapName":"base-cell","tileNumber":1,"piece":"WHITE","position":{"x":7,"y":0},"empty":false,"occupied":true},"7,1":{"tileMapName":"base-cell","tileNumber":0,"piece":"WHITE","position":{"x":7,"y":1},"empty":false,"occupied":true},"7,2":{"tileMapName":"base-cell","tileNumber":1,"piece":"WHITE","position":{"x":7,"y":2},"empty":false,"occupied":true},"7,3":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":7,"y":3},"empty":true,"occupied":false},"3,0":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":3,"y":0},"empty":true,"occupied":false},"7,4":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":7,"y":4},"empty":true,"occupied":false},"3,1":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":3,"y":1},"empty":true,"occupied":false},"7,5":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":7,"y":5},"empty":true,"occupied":false},"3,2":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":3,"y":2},"empty":true,"occupied":false},"7,6":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":7,"y":6},"empty":true,"occupied":false},"3,3":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":3,"y":3},"empty":true,"occupied":false},"7,7":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":7,"y":7},"empty":true,"occupied":false},"3,4":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":3,"y":4},"empty":true,"occupied":false},"3,5":{"tileMapName":"base-cell","tileNumber":0,"piece":"BLACK","position":{"x":3,"y":5},"empty":false,"occupied":true},"3,6":{"tileMapName":"base-cell","tileNumber":1,"piece":"BLACK","position":{"x":3,"y":6},"empty":false,"occupied":true},"3,7":{"tileMapName":"base-cell","tileNumber":0,"piece":"BLACK","position":{"x":3,"y":7},"empty":false,"occupied":true},"4,0":{"tileMapName":"base-cell","tileNumber":0,"piece":"WHITE","position":{"x":4,"y":0},"empty":false,"occupied":true},"4,1":{"tileMapName":"base-cell","tileNumber":1,"piece":"WHITE","position":{"x":4,"y":1},"empty":false,"occupied":true},"4,2":{"tileMapName":"base-cell","tileNumber":0,"piece":"WHITE","position":{"x":4,"y":2},"empty":false,"occupied":true},"4,3":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":4,"y":3},"empty":true,"occupied":false}}},"player1":{"name":"test1"},"player2":{"name":"test2"},"initiator":{"name":"test1"},"winner":null,"turns":[],"currentTurn":"WHITE","player1Piece":"WHITE","player2Piece":"BLACK","finishReason":null,"createdAt":"2025-09-01T22:19:41.173762318","updatedAt":"2025-09-01T22:19:52.219367437","field":{"0,0":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":0,"y":0},"empty":true,"occupied":false},"4,4":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":4,"y":4},"empty":true,"occupied":false},"0,1":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":0,"y":1},"empty":true,"occupied":false},"4,5":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":4,"y":5},"empty":true,"occupied":false},"0,2":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":0,"y":2},"empty":true,"occupied":false},"4,6":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":4,"y":6},"empty":true,"occupied":false},"0,3":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":0,"y":3},"empty":true,"occupied":false},"4,7":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":4,"y":7},"empty":true,"occupied":false},"0,4":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":0,"y":4},"empty":true,"occupied":false},"0,5":{"tileMapName":"base-cell","tileNumber":1,"piece":"BLACK","position":{"x":0,"y":5},"empty":false,"occupied":true},"0,6":{"tileMapName":"base-cell","tileNumber":0,"piece":"BLACK","position":{"x":0,"y":6},"empty":false,"occupied":true},"0,7":{"tileMapName":"base-cell","tileNumber":1,"piece":"BLACK","position":{"x":0,"y":7},"empty":false,"occupied":true},"5,0":{"tileMapName":"base-cell","tileNumber":1,"piece":"WHITE","position":{"x":5,"y":0},"empty":false,"occupied":true},"5,1":{"tileMapName":"base-cell","tileNumber":0,"piece":"WHITE","position":{"x":5,"y":1},"empty":false,"occupied":true},"5,2":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":5,"y":2},"empty":true,"occupied":false},"5,3":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":5,"y":3},"empty":true,"occupied":false},"1,0":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":1,"y":0},"empty":true,"occupied":false},"5,4":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":5,"y":4},"empty":true,"occupied":false},"1,1":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":1,"y":1},"empty":true,"occupied":false},"5,5":{"tileMapName":"base-cell","tileNumber":0,"piece":"WHITE","position":{"x":5,"y":5},"empty":false,"occupied":true},"1,2":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":1,"y":2},"empty":true,"occupied":false},"5,6":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":5,"y":6},"empty":true,"occupied":false},"1,3":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":1,"y":3},"empty":true,"occupied":false},"5,7":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":5,"y":7},"empty":true,"occupied":false},"1,4":{"tileMapName":"base-cell","tileNumber":1,"piece":"BLACK","position":{"x":1,"y":4},"empty":false,"occupied":true},"1,5":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":1,"y":5},"empty":true,"occupied":false},"1,6":{"tileMapName":"base-cell","tileNumber":1,"piece":"BLACK","position":{"x":1,"y":6},"empty":false,"occupied":true},"1,7":{"tileMapName":"base-cell","tileNumber":0,"piece":"BLACK","position":{"x":1,"y":7},"empty":false,"occupied":true},"6,0":{"tileMapName":"base-cell","tileNumber":0,"piece":"WHITE","position":{"x":6,"y":0},"empty":false,"occupied":true},"6,1":{"tileMapName":"base-cell","tileNumber":1,"piece":"WHITE","position":{"x":6,"y":1},"empty":false,"occupied":true},"6,2":{"tileMapName":"base-cell","tileNumber":0,"piece":"WHITE","position":{"x":6,"y":2},"empty":false,"occupied":true},"6,3":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":6,"y":3},"empty":true,"occupied":false},"2,0":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":2,"y":0},"empty":true,"occupied":false},"6,4":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":6,"y":4},"empty":true,"occupied":false},"2,1":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":2,"y":1},"empty":true,"occupied":false},"6,5":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":6,"y":5},"empty":true,"occupied":false},"2,2":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":2,"y":2},"empty":true,"occupied":false},"6,6":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":6,"y":6},"empty":true,"occupied":false},"2,3":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":2,"y":3},"empty":true,"occupied":false},"6,7":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":6,"y":7},"empty":true,"occupied":false},"2,4":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":2,"y":4},"empty":true,"occupied":false},"2,5":{"tileMapName":"base-cell","tileNumber":1,"piece":"BLACK","position":{"x":2,"y":5},"empty":false,"occupied":true},"2,6":{"tileMapName":"base-cell","tileNumber":0,"piece":"BLACK","position":{"x":2,"y":6},"empty":false,"occupied":true},"2,7":{"tileMapName":"base-cell","tileNumber":1,"piece":"BLACK","position":{"x":2,"y":7},"empty":false,"occupied":true},"7,0":{"tileMapName":"base-cell","tileNumber":1,"piece":"WHITE","position":{"x":7,"y":0},"empty":false,"occupied":true},"7,1":{"tileMapName":"base-cell","tileNumber":0,"piece":"WHITE","position":{"x":7,"y":1},"empty":false,"occupied":true},"7,2":{"tileMapName":"base-cell","tileNumber":1,"piece":"WHITE","position":{"x":7,"y":2},"empty":false,"occupied":true},"7,3":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":7,"y":3},"empty":true,"occupied":false},"3,0":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":3,"y":0},"empty":true,"occupied":false},"7,4":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":7,"y":4},"empty":true,"occupied":false},"3,1":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":3,"y":1},"empty":true,"occupied":false},"7,5":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":7,"y":5},"empty":true,"occupied":false},"3,2":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":3,"y":2},"empty":true,"occupied":false},"7,6":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":7,"y":6},"empty":true,"occupied":false},"3,3":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":3,"y":3},"empty":true,"occupied":false},"7,7":{"tileMapName":"base-cell","tileNumber":0,"piece":null,"position":{"x":7,"y":7},"empty":true,"occupied":false},"3,4":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":3,"y":4},"empty":true,"occupied":false},"3,5":{"tileMapName":"base-cell","tileNumber":0,"piece":"BLACK","position":{"x":3,"y":5},"empty":false,"occupied":true},"3,6":{"tileMapName":"base-cell","tileNumber":1,"piece":"BLACK","position":{"x":3,"y":6},"empty":false,"occupied":true},"3,7":{"tileMapName":"base-cell","tileNumber":0,"piece":"BLACK","position":{"x":3,"y":7},"empty":false,"occupied":true},"4,0":{"tileMapName":"base-cell","tileNumber":0,"piece":"WHITE","position":{"x":4,"y":0},"empty":false,"occupied":true},"4,1":{"tileMapName":"base-cell","tileNumber":1,"piece":"WHITE","position":{"x":4,"y":1},"empty":false,"occupied":true},"4,2":{"tileMapName":"base-cell","tileNumber":0,"piece":"WHITE","position":{"x":4,"y":2},"empty":false,"occupied":true},"4,3":{"tileMapName":"base-cell","tileNumber":1,"piece":null,"position":{"x":4,"y":3},"empty":true,"occupied":false}},"mapSize":{"width":8,"height":8},"currentPlayer":{"name":"test1"},"isStarted":true,"isFinished":false}');

const config: Types.Core.GameConfig = {
  type: CANVAS, //todo: AUTO is resolved to WEBGL which causes some gaps between tiles on mobiles sometimes
  width: '100%',
  height: '80%',
  parent: GAME_CONTAINER_ID,
  pixelArt: true,
  antialias: false,
  scale: {
    mode: Phaser.Scale.NONE, // FIT to enable scaling when type: AUTO issue is fixed. Gaps are present even when mode = NONE and type = AUTO
    autoCenter: Phaser.Scale.CENTER_BOTH,
  },
  scene: [
    MainGame
  ]
};

const game = new Game({ ...config, parent: "game-container", backgroundColor: "#000000" });
game.registry.set(GLOBAL_REGISTRY_TRANSLATIONS, (s: string) => s);
game.registry.set(GLOBAL_REGISTRY_GAME_DATA, testGame);
game.registry.set(GLOBAL_REGISTRY_PLAYER, testGame.player1);

document.getElementById('test')!.innerText = window.location.search;
